<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-12 bg-primary">
                <h2 class="h2 text-light text-center pt-5">App de gastos</h2>
                <h2 class="h2 text-light text-center">Ingresa cuanto pagó cada persona</h2>
            </div>
        </div>
        <div class="input-group flex-nowrap pt-1">
            <input type="text" class="form-control" id="name" placeholder="Nombre completo" aria-describedby="addon-wrapping">
        </div>
        <div class="input-group flex-nowrap pt-1">
            <input type="number" class="form-control" id="amount" placeholder="Monto" aria-describedby="addon-wrapping">
        </div>
        <div class="pt-1">
            <button type="submit" class="btn btn-danger pt-1" id="save">Enviar</button>
        </div>
        <div class="pt-1 new-screens">
        </div>
        <div class="container pt-1">
            <p class="total p-0 m-0">
                Total: 
            </p>
            <p class="Cresult p-0 m-0">
                A cada uno le toca aportar: 
            </p>
        </div>
    </div>
    <script src="app.js"></script>
    <script>
        // initializing variables
        let DISPLAY_NAME = document.getElementById('name'),
            DISPLAY_AMOUNT = document.getElementById('amount'),
            TOTAL,
            TOTAL_INDIVIDUAL;
        var DICTIONARY = {},
        BTN = document.getElementById('save');

        // initializing functions
        function Screen(name, amount) {
            this.name = name;
            this.amount = amount;
            this.card = document.createElement('div');
            this.card.className = 'card';
            this.card.innerHTML = `
                <div class="card-body">
                    <span class="name card-title h5">${this.name} gastó</span>
                    <span class="amount card-text h5">$${this.amount}</span>
                </div>
            `;
            this.card.addEventListener('click', function() {
                let name = this.querySelector('.name').textContent;
                delete DICTIONARY.name;
                console.log(DICTIONARY);
                this.remove();
            });
            document.querySelector('.new-screens').appendChild(this.card);
        }
        function calculateTotal() {
            TOTAL=0;
            for (let key in DICTIONARY) {
                TOTAL += DICTIONARY[key];
            }
            return TOTAL;
        }
        // Creating a function that changes the content of the class total and Cresult
        function changeContent() {
            document.querySelector('.total').innerHTML = `Total: $${TOTAL}`;
            document.querySelector('.Cresult').innerHTML = `A cada uno le toca aportar: $${TOTAL_INDIVIDUAL}`;
        }
        // Creating a function that divides the number of total by the amount of people
        function calculateIndividual() {
            let TOTAL_INDIVIDUAL = TOTAL / Object.keys(DICTIONARY).length;
            return TOTAL_INDIVIDUAL;
        }
        var Refresh = function() {
            if (DISPLAY_NAME.value && DISPLAY_AMOUNT.value) {
                name = DISPLAY_NAME.value,
                amount = parseFloat(DISPLAY_AMOUNT.value);
                let screen = new Screen(name, amount);
                DICTIONARY[name] = amount;
                console.log(DICTIONARY);
                TOTAL = calculateTotal();
                TOTAL_INDIVIDUAL = calculateIndividual();
                changeContent();
            }
        }
        // initializing events
        BTN.addEventListener('click', Refresh);

    </script>
</body>
</html>